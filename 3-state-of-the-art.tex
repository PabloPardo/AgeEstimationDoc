\chapter{State of the art} \label{chap:sota}

Age estimation has historically been one of the most challenging problems within the field of facial analysis \cite{5406526}\cite{han:age}. Despite the multiple applications in many different areas of age estimation there are relatively few publications compared to other topics in facial analysis. This difficulty is due to many factors: 
\begin{itemize}
	\item Depending on the application scenario, the age estimation problem can be taken as a multiclass classification problem or a regression problem.
	\item Large database are difficult to collect, especially series of chronological image from the same individuals.
	\item The factors the affect the ageing process are uncontrollable and person specific \cite{4284917}\cite{4359348}\cite{1709980}.
\end{itemize}

The age estimation problem has generally three stages or blocks, the first one is the face detection and alignment, the second one is the age representation in the images and the third one the estimation itself with the computed data. There are many different techniques for both stages. \cite{5406526}

\section{Face Detection and Alignment}
\note{See whether to write this section or not}
\section{Age Representation}

Age Representation is a very important step in the age estimation process. A good age representation will contain enough variation of the data to express the full complexity of the problem. There are many ways in the literature to represent ageing factors from an image, the most important are described below.

\subsection{Anthropomorphic Models}
The first known work on age estimation from facial images was done by Y. Kwon and N. Lobo \cite{Kwon:1999:ACF:311844.311845}. Their approach is based in cranio-facial development theory using geometrical ratios between different face regions to classify images into one of three age groups (babies, young adults and senior adults). They used frontal images in a very strict set up to be able to locate all face components. N. Ramanathan et al. \cite{1640784, Ramanathan2009131} used a similar approach in this case using 8 ratios rather than the 6 used by Y. Kwon et al.

The problem of this model is that only can be applied to face images of young people in a growing age since afterwards the facial geometry does not change as much. It is also a problem that the methods require of frontal images since it limits the future applications.

\subsection{Active Appearance Models}

Active Appearance Models (AAM) is a statistical shape model proposed by T.F Cootes et al. \cite{Cootes:2001:AAM:378040.378090}. This model contains the shape and grey-level appearance of the object of interest which can generalize to almost any valid example. This technique has been used to find the shape of faces by many researchers. A. Lanitis et al. \cite{791208, 993553, Lanitis:2004:CDC:2225304.2226166} were the first in extend the AAM model for age estimation by defining an ageing function $age=f(b)$, where \textbf{f} is an ageing function and \textbf{b} is a vector containing the parameters learned by the AAM.

A. Lanitis et al. \cite{Lanitis:2004:CDC:2225304.2226166} also tried different classifiers such as Quadratic Functions, Shortest Distance Classifier, Supervised Neural Network and Unsupervised Neural Network. Among all of them they reported that Quadratic Functions where the ones performing best.

This model captures shape and texture information and in general performs better than the \textit{Anthropomorphic Models}. This method can deal with any range of ages rather than just with young ages like the previous model. However, as suggested by X. Geng et al. \cite{Geng:2006:LFA:1180639.1180711}, the ageing functions is empirically determined, so there is no evidence suggesting that the relation between face and age is described just by a quadratic function.

\subsection{Ageing Pattern Subspace}

X. Geng et al. \cite{4359348, Geng:2006:LFA:1180639.1180711} were the ones that explored this model initially which is called AGing pattErn Subspace (AGES). They define an \textit{ageing pattern} as a sequence of personal face images sorted in time order. Given a grey-scale face image $\textbf{I}$, where $\textbf{I}(x,y)$ determines the intensity of the pixel $(x,y)$, then an ageing pattern can be represented as a three-dimensional matrix $\textbf{P}$, where $\textbf{P}(x,y,t)$ is the intensity of the pixel $(x,y)$ in the face image at the time $t$. The images vector is filled with the available face images leaving empty the missing faces in the $t$ axis. Now, the images in the age pattern vector can be precessed and transformed into meaningful feature vectors.

In order to extract the features X. Geng use AAM as used in \cite{791208} since they capture the shape and texture of the face images. By representing ageing patterns in this way, the concepts of identity and time are naturally integrated into the data without any pre-assumptions.

The principal drawback of the AGES method is that assumes that there are images of the same individual at different ages, which is not true in all the age databases, like in the Yamaha Gender and Age (YGA) database \cite{4523958}, and it is difficult to collect such a databases.

\subsection{Age Manifold}
 
The manifold learning methods are applied to find a sufficient embedding space and model the low-dimensional manifold data with a multiple linear regression function. Y. Fu et al. \cite{4523958, 4284917} were the first in proposing a manifold embedding approach for the age estimation problem. 

The objective of this method is to find the low-dimensional representation in the embedded subspace capturing the intrinsic data distribution and geometric structure as well as its representation. G. Guo et al. \cite{Guo:2008:IHA:2319085.2321608} \cite{4531189} shows that the Orthogonal Locality Preserving Projections (OLPP) \cite{CHHZ06}  is a good an effective algorithm  to connect the manifold learning with subspace learning. In a posterior work \cite{5995404}, G. Guo et al. introduces a new approach, using kernel partial least square (KPLS) regression which reduces feature dimensionality and learn the ageing function in a single step.

Then T. Wu et al. \cite{journals/tifs/WuTC12} proposed to model the facial shapes as points on a Grassmann manifold. Age estimation is then considered as regression and classification problems on this manifold. Then, they proposed a method for combining this shape-based approach with other texture-based algorithms.

The main drawback of the age manifold representation is the number of training instances required to learn the embedded manifold with statistical sufficiency.

\subsection{Appearance Models}

Appearance Models focus on wrinkles, face texture and pattern analysis. From the beginning, researchers have tried to capture wrinkles and distinguish them from facial lines. Y. Kwon et al. \cite{Kwon:1999:ACF:311844.311845} proposed a wrinkle detector based on snakelets \cite{Kass88snakes:active} placed into key wrinkle areas of the face. Hayashi et al. \cite{969698} \cite{1195171} \cite{conf/icpr/HayashiYIK02} combined both shape and texture to estimate age and gender. In Hayashi's proposed approach, the skin is extracted based on a shape model and then a histogram equalization is applied to emphasize wrinkles.

Other researchers have used the texture descriptor Local Binary Patterns (LBP) \cite{Ahonen:2006:FDL:1175897.1176245} in the age estimation problem, such as \cite{4717926} \cite{6460367} obtaining good classification results with Nearest Neighbour and SVM classification algorithms. The Gabor \cite{Liu:2002:GFB:2319007.2320264} filter texture descriptor has also been used in the age estimation task  \cite{Gao:2009:FAC:1567988.1568003}, probing to be more discriminative than LBP.

G. Guo et al. \cite{conf/cvpr/GuoMFH09} proposed to use Biological Inspired Features (BIF) \cite{Riesenhuber99hierarchicalmodels} for age estimation via faces. The BIF descriptor tries to mimic how the visual cortex works, with a hierarchy of increasingly sophisticated representations.

\note{To Finish}

G. Guo et al. proposed different approaches to the age estimation problem such as
\cite{4563041}, where they propose probabilistic fusion approach, or \cite{conf/cvpr/GuoMFH09} where they introduce the Biological Inspired Features (BIF) for the age estimation problem and propose some changes adding a novel "STD" operator. H. Han et al. \cite{han:age} uses the BIF features in an hybrid classification framework improving the previous results. G. Guo et al. \cite{Guo2014761}, in a recent paper (2014), used the BIF features, and focus to investigate a proposed single-step framework for joint estimation of age, gender and ethnicity. Both the CCA (Canonical Correlation Analysis) and PLS (Partial Least Square) based methods were explored under the joint estimation framework.

Under the same idea as Y. Fu et al. \cite{4284917}, K. Luu et al. \cite{Luu:2009:AEU:1736406.1736456, LuuSSBS11} reduced dimensionality by using facial landmarks and Active Shape Models (ASM) \cite{Luu:2009:AEU:1736406.1736456} and an improved version, Contourlet Appearance Model (CAM) \cite{LuuSSBS11}, where they prove the efficiency of using facial landmarks.

\subsection{Other}
\note{To Finish}

There are some other variations of the age estimation problem which require different approaches. 

Later N. Ramanathan et al. \cite{1709980} approached the age estimation problem by estimating the age difference between two face images of the same individual based on a Bayesian age-difference classifier.

Other different variations of the problem has been addressed, A. Lanitis et al. \cite{5463396} performed a first approach to age estimation using Head and Mouse tracking movements, Y. Makihara et al. \cite{6117531} used a gait-based database to estimate the age, B. Xia et al. \cite{xia:hal-00904007} proposed an age estimation method based on 3D face images.


\section{Age Estimation Algorithm}
Given an age representation, the next step is to determine the individual's age out of the ageing features. Age labels can be seen as a discrete set of classes or as a continuous label space, hence classification and regression methods can be used.

\subsection{Classification Methods}
\note{Finish}
\subsection{Regression Methods}
\note{Finish}
\subsection{Hybrid Methods}
\note{Finish}

\begin{table}[h!]
	\centering
	\resizebox{\textwidth}{!}{
		\begin{tabular}{|l|c|M{3cm}|M{3cm}|M{3cm}|c|c|N}
			\cline{1-7}
			\rowcolor[HTML]{EFEFEF} 
			\hline
			\textbf{Publication} & 
			\textbf{Year} &
			\textbf{Database (\#subjects, \#images)} &
			\textbf{Age Image Representation} &
			\textbf{Method} & 
			\textbf{Accuracy} & 
			\textbf{MAE} &\\[8pt] \hline
			\multicolumn{1}{|p{2.5cm}|}{\textbf{A. Lanitis et al. \cite{993553}}} & 2002 & Private (60, 500) & Active Appearance Models & Quadratic Aging Function & 71$\%$ & $3.94\pm3.8$&\\[5pt] \hline
			\multicolumn{1}{|p{2.5cm}|}{\textbf{A. Lanitis et al. \cite{Lanitis:2004:CDC:2225304.2226166}}} & 2004 & Private (40, 400) & Active Appearance Models & Quadratic Aging Function & N/A & $3.82\pm5.58$&\\[5pt] \hline
			\multicolumn{1}{|p{2.5cm}|}{\textbf{X. Geng et al. \cite{Geng:2006:LFA:1180639.1180711}}} & 2006 & FG-NET (82, 1.002) & AGES & Regression & N/A & $6.77$ &\\[5pt] \hline
			\note{Add More Methods}&&&&&&&\\\hline
		\end{tabular}
	}
	\caption{Age Estimation Methods}
	\label{tab:age-methods}
\end{table}

\section{Applications}
There are many real-world application related to age estimation. Automatic age estimation is useful in situations where there is no need to specifically identify the individual, such as a government employee, but want to know his or her age.

\subsection{Security Control and Surveillance Monitoring}
In the last years security control and surveillance monitoring have gotten more relevant with the growth of internet content and the spread of technology that allows access to that content to under-age teenagers. Automatic age estimation systems can be used to prevent minors to buy alcohol in a grocery store, enter a bar or purchase tobacco from vending machines.

\subsection{Biometrics}
There are two types of biometric systems based on the number of traits used for recognition, unimodal biometric systems which consist on a single recognition trait and multimodal biometric systems, which combines evidences obtained from multiple sources \cite{MSU-CSE-99-39} such as fingerprints, iris, face, etc. The multimodal system is more robust, more reliable and secure against spoof attacks. However, the data acquisition is much more troublesome than the unimodal. In order to overcome this inconveniences, soft-biometrics \cite{conf/icba/JainDN04}, such as age, hight, weigh, gender, ethnicity and eye colour, are used in combination with classic biometric traits. 

\subsection{Age-based Indexing Face Databases}
With the rise of interest for big data new and more efficient ways to retrieve data have to be developed. In large face image datasets, age can be used for index such a databases so the queries to the dataset are simpler and faster. This is specially important in law enforcement where large image databases of suspects have to be filtered in order to find the most accurate suspects.

\subsection{Human-Computer Interaction and e-Commerce}
With the growth of e-commerce, companies want to offer a more personalized experience to their customers. Personalizing the offer or the product itself increase the user's satisfaction and the companies sells. Some examples of such a policies are the following: Google \cite{Brin:1998:ALH:297810.297827} indexes the search results so the links that appear first appeal more to the user, Amazon \cite{Linden:2003:ARI:642462.642471} uses a recommender system to suggest products to the potential buyers according to their previous purchases, Netflix \cite{Koren:2009:MFT:1608565.1608614} held a competition in 2009 to create a film recommender system and gave a price of US \$1,000,000. Age estimation system could have an important role in the sector since age is a discriminative feature for different client profiles. Visada \cite{visada} is an example of the use of age estimation for recommend products.


\section{Age-based Datasets} \label{sec:ageDB}
There are many databases of faces in the literature, however, not so many capture the age of the individuals. This fact is due to the complexity of crawling such an information (if existent) from the usual fonts such as \textit{Flickr} or \textit{Facebook} and due to privacy issues. Moreover, the difficulty is even higher if the database contains chronological image series of individuals. The Table \ref{tab:age-db} shows the most relevant databases used in the literature with the number of samples, the number of subjects, the age range, the type of age annotations and additional information if any. The \textit{FG-NET} \cite{993553} is one of the first and most consolidated age database, it is used to compare with other age estimation methods.

After an initial interest in automatic age estimation from images dated back to the early 2000s \cite{Lanitis:2004:CDC:2225304.2226166}, \cite{993553}, \cite{palDB}, research in the field has experienced a renewed interest from 2006 on, since the availability of large databases like \textit{MORPH-Album 2} \cite{1613043}, which contains 55 times more age-annotated images than the \textit{FG-NET} database.

\begin{table}[t!]

\centering
\resizebox{\textwidth}{!}{

\begin{tabular}{|l|c|c|c|c|M{2.5cm}|M{2.5cm}|M{2.5cm}|N}
	\hline
	\cline{1-8}
	\hline
	\cellcolor[HTML]{EFEFEF}\textbf{Database} & \cellcolor[HTML]{EFEFEF}\textbf{\#Faces} & \cellcolor[HTML]{EFEFEF}\textbf{\#Subj.} & \cellcolor[HTML]{EFEFEF}\textbf{Range} & \cellcolor[HTML]{EFEFEF}\textbf{Type of age} & \cellcolor[HTML]{EFEFEF}\textbf{Controlled Env.} & \cellcolor[HTML]{EFEFEF}\textbf{Balanced age Distr.} & \cellcolor[HTML]{EFEFEF}\textbf{Other annotation} &\\[8pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{FG-NET \cite{993553, FGNET}}} & 1,002 & 82 & 0 - 69 & Real Age & No & No & 68 Facial Landmarks &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{GROUPS \cite{gallagher_cvpr_09_groups}}} & 28,231 & 28,231 & 0 - 66+ & Age group & No & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{PAL \cite{palDB}}} & 580 & 580 & 19 - 93 & Age group & No & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{FRGC \cite{frgcDB}}} & 44,278 & 568 & 18 - 70 & Real Age & Partially & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{MORPH2 \cite{1613043}}} & 55,134 & 13,618 & 16 - 77 & Real Age & Yes & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{YGA \cite{4523958}}} & 8,000 & 1,600 & 0 - 93 & Real Age & No & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{FERET\cite{Phillips1998295}}} & 14,126 & 1,199 & - & Real Age & Partially & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{Iranian face \cite{4469272}}} & ~3,600 & 616 & 2 - 85 & Real Age & No & No & Kind of skin and cosmetic points \footnote{Surgical points, fracture or laceration on face.}  &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{PIE \cite{1004130}}} & 41,638 & 68 & - & Real Age & Yes & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{WIT-BD \cite{Ueki:2006:SAC:1126250.1126269}}} & 26,222 & 5,500 & 3 - 85 & Age group & No & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{Caucasian Face Database \cite{burt1995perception}}} & 147 & - & 20 - 62 & Real Age & Yes & No & Shape represented in 208 key points &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{LHI \cite{LHI}}} & 8,000 & 8,000 & 9 - 89 & Real Age & Yes & Yes & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{HOIP \cite{HOIP}}} & 306,600 & 300 & 15 - 64 & Age Group & Yes & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{Ni's Web-Collected Database \cite{Ni:2009:WIM:1631272.1631287}}} & 219,892 & - & 1 - 80 & Real Age & No & No & - &\\[5pt] \hline
	
	\multicolumn{1}{|p{2cm}|}{\textbf{OUI-Adience \cite{6906255}}} & 26.580 & 2.284 & 0 - 60+ & Age Group & No & No & Gender &\\[5pt] \hline

\end{tabular}

}

\caption{Age-based Databases}
\label{tab:age-db}

\end{table}
